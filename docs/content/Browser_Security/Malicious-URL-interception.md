# Malicious URL interception

恶意网址拦截

---

## 恶意网址黑名单

为了保护用户安全，浏览器厂商纷纷推出了各自的拦截恶意网址功能。目前各个浏览器的拦截恶意网址的功能都是基于黑名单的。恶意网址拦截的工作原理很简单，一般都是浏览器周期性地从服务器端获取一份最新的恶意网址黑名单，如果用户上网时访问的网址存在于此黑名单中，浏览器就会弹出一个警告页面。

![Malicious URL](img/Malicious-1.png)

常见的恶意网址分为两类：一类是挂马网站，这些网站通常包含有恶意的脚本如JavaScript或 Flash，通过利用浏览器的漏洞（包括一些插件、控件漏洞）执行 shellcode，在用户电脑中植入木马;另一类是钓鱼网站，通过模仿知名网站的相似页面来欺骗用户。

要识别这两种网站，需要建立许多基于页面特征的模型，而这些模型显然是不适合放在客户端的，因为这会让攻击者得以分析、研究并绕过这些规则。同时对于用户基数巨大的浏览器来说，收集用户访问过的历史记录也是一种侵犯隐私的行为，且数据量过于庞大。

基于这两个原因，浏览器厂商目前只是以推送恶意网址黑名单为主，浏览器收到黑名单后，对用户访问的黑名单进行拦截;而很少直接从浏览器收集数据，或者在客户端建立模型。现在的浏览器多是与专业的安全厂商展开合作，由安全厂商或机构提供恶意网址黑名单。

##EV SSL 证书

除了恶意网址黑名单拦截功能外，主流浏览器都开始支持 EV SSL证书（Extended Validation SSL Certificate），以增强对安全网站的识别。

EVSSL证书是全球数字证书颁发机构与浏览器厂商一起打造的增强型证书，其主要特色是浏览器会给予EV SSL证书特殊待遇。EV SSL证书也遵循X509标准，并向前兼容普通证书。如果浏览器不支持EV模式，则会把该证书当做普通证书;如果浏览器支持EV模式，则会在地址栏中特别标注。

左边的是普通证书，右边的是EV证书：

![EV SSL](img/Malicious-2.png)

使用了EV 证书，在地址栏也会有醒目的“绿色”标识，以对抗钓鱼网站。